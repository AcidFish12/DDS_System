# DDS_System
A DDS System based on FPGA and MSP430
摘要

此项目也是学校培训的项目，采用MSP430单片机和FPGA作为控制核心，设计制作了DDS信号发射器。系统包括DA转换电路、滤波电路、放大电路和单片机与FPGA构成的控制模块组成。FPGA产生数字信号，经过DA转换后形成锯齿样正弦信号，再通过滤波后产生平滑的正弦波信号。同时还有一路产生方波信号，经滤波后产生正弦信号。经测试，第一路可产生正弦波信号和AM调制限号。其中正弦波频率三档可调，AM调制信号载波频率，调制波频率，调制度分别可调。第一路和第二路产生的正弦信号可形成李萨如图形。频率设置准确，波形无明显失真。
关键词：DDS，AM调制，FPGA

1.系统总体方案描述
![image](https://user-images.githubusercontent.com/75008732/175979701-97d0b20b-731f-46cd-8439-dd6b2c8d437c.png)
图 1.1 系统总体框图
系统由msp430和FPGA组成控制模块。FPGA产生的数字信号由DA模块转换成模拟信号，滤波器1滤去杂波是的信号平滑，运放使得信号达到要求的大小。另一路产生方波信号，经滤波器滤波后产生正弦波，得到要求的信号。人机交互使用键盘实现。

2.软件部分描述

2.1正弦产生模块
正弦产生模块，由  ROM  IP核读取正弦查找表实现。MATLAB生成宽度14位深度2048的正弦查找表。然后经过相位累加器生成正弦信号。通过设定不同的K即可得到不同的输出频率。其中fclk=100Mhz，N=14.
![image](https://user-images.githubusercontent.com/75008732/175980243-b37514d3-1b28-47b6-99cb-a28e0ce10f87.png)
![image](https://user-images.githubusercontent.com/75008732/175980324-d73491f3-3f6a-406e-ae5b-68a6b3f02c7d.png)
考虑到该公式只能最小产生（100M/2^14）Hz的频率，将K放大2^20倍，读取地址时候再左移20位，得到：
![image](https://user-images.githubusercontent.com/75008732/175980369-5f609307-8136-42cd-9178-2d5898274495.png)
通过设置fout即可获得任意频率的正弦信号。

2.2AM调幅模块设计
AM调幅波通过调用产生的频率不同的正弦波相乘实现。
 ![image](https://user-images.githubusercontent.com/75008732/175980625-a7963cb3-744e-4ec3-a33d-daa32cb58eb6.png)
调制波信号=载波信号[调制信号(ma+调制信号一半振幅)
其中ma同样采用放大再缩小的方法实现浮点数的运算。考虑到正弦产生模块产生的正弦信号为无符号数，需要先将其转换为有符号数再使用IP核相乘获得需要的调制波信号。

2.3总体描述
系统设置有两个模式，分别产生正弦波和AM调制波。初始化后进入输出正弦波模式。在该模式下分别通过6个按键实现三档频率的加减步进调节。直接通过按键可以跳转到AM调幅波模式，该模式下有一档频率步进可调，同时载波频率以及调制度也有一档步进可调。步进调节部分都设有保护机制，若调节超出设定值则跳转至默认数值。其中步进输入时候需消抖程序防止输入过快。
![image](https://user-images.githubusercontent.com/75008732/175980999-495d9351-fb8a-42c9-9d87-3c709f31155d.png)

相关verilog工程文件均在DDS_4.0中。

